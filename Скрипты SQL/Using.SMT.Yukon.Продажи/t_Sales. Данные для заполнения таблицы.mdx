SELECT
	{
		[Measures].[Количество]
		,[Measures].[Количество коробок]
		,[Measures].[Сумма продаж]
	} ON COLUMNS
	,
	NON EMPTY
		(
		[13 Документы продаж].[ID].[ID]
		,[13 Документы продаж].[Дата документа].[Дата документа]
		,[13 Документы продаж].[Номер документа].[Номер документа]
		,[05 Контрагенты].[ID].[ID]
		,[06 Торговые точки].[ID].[ID]
		,[07 Маршруты].[ID].[ID]
		,[13 Документы продаж].[Дата доставки].[Дата доставки]
		,[13 Документы продаж].[Дата оплаты].[Дата оплаты]
		)
	ON ROWS
FROM [Sales]
WHERE (
	[07-01-01 Системы мобильной торговли].[Система мобильной торговли].&[Yukon-PG]
	,[13 Документы продаж].[IsBonusDoc].&[False]
	,StrToMember('[13 Документы продаж].[Месяц документа-Дата документа].[Дата документа].&['+Format(DateAdd('M', -3, NOW()), 'yyyy-MM-dd') + 'T00:00:00]').Parent.FirstChild
	:StrToMember('[13 Документы продаж].[Месяц документа-Дата документа].[Дата документа].&['+Format(DateAdd('D', 3, NOW()), 'yyyy-MM-dd') + 'T00:00:00]')
)
